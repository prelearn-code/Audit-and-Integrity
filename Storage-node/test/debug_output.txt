
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🧪 文件证明完整调试测试程序
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
所有中间数据将输出到: debug_output.txt
每个关键步骤都会暂停等待用户确认

📥 加载公共参数...
✅ 公共参数加载成功

📥 加载索引数据库...
✅ 索引数据库加载成功
📊 文件总数: 8

💡 可用的文件ID:
   1. 112412990991109694830000904384586588555399089313956461726215147651497902069106
   2. 114979655417370403541719137063601258928368721237137711268582054570346892119785
   3. 15030926821912326204673978653733110398631717501691714889379196689817920475806
   4. 29623136847719743332609599635319152073467003710545598034443509938335505712094
   5. 40799672443157958870363424046259634317818841615886637576392959089246845347654
✅ 找到文件: 15030926821912326204673978653733110398631717501691714889379196689817920475806

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔨 文件证明生成 - 完整调试版本
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
文件ID: 15030926821912326204673978653733110398631717501691714889379196689817920475806

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤1】加载文件信息
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 文件信息加载成功
  块数量 n: 5
    公钥 PK:
    长度: 256 字符
    前32位: 0b97c9dd3c4a8a90ca1cdb176e937156...
    后32位: eae926c30a35160d50c7d192d81c5c71
    TS_F[0]:
    长度: 256 字符
    前32位: 84798ebcec7ae09be6c73c8e59d15700...
    后32位: 0b3fe25afc512eaa16f285a01fe2ec52
    TS_F[1]:
    长度: 256 字符
    前32位: 0b8a8a4ff1e32a7cff580b0a24776e0a...
    后32位: b4309cd124607766398e0408a8d83c5e
    TS_F[2]:
    长度: 256 字符
    前32位: a46a57789159d94f43a30967b25752f5...
    后32位: 1134438232151f6ce90e6741cea2c78e
  ... (共 5 个认证标签)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤2】加载密文文件
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 密文加载成功
  密文大小: 18992 bytes
  BLOCK_SIZE: 4096 bytes
  SECTOR_SIZE: 256 bytes
  每块扇区数: 16
  密文前64位: 3e489ed006ec5cb30b03e59240739ebf35d16a181e25835c89bc48b4506f0b1e...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤3】生成随机种子
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 种子生成成功
    seed:
    长度: 64 字符
    完整: eb3e57764547952feef74615633ab0e94d9a30ff3e510d1adbc735a9587fe458

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤4】初始化累积变量
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ phi_element 初始化为单位元 1
    phi_element (初始):
    长度: 256 字符
    前32位: 00000000000000000000000000000000...
    后32位: 00000000000000000000000000000000
✅ psi_mpz 初始化为 0
    psi_mpz (初始):
    长度: 1 字符
    完整: 0

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤5】主循环 - 遍历所有块
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
开始遍历 5 个块...

┌─────────────────────────────────────────┐
│ 处理块 [0/4]
└─────────────────────────────────────────┘

  [5.1] 计算 PRF(seed, ID_F, 0)
    ✅ PRF 计算完成
      prf_result:
    长度: 64 字符
    前32位: a090ca885005a348134cc83580ebf806...
    后32位: fa0e82644da6a317b0e77e26edcea1e3

  [5.2] 处理块的所有扇区
    块起始位置: 0
    块结束位置: 4096
    块大小: 4096 bytes

    扇区 [0] (首个扇区详情):
      起始: 0
      结束: 256
      大小: 256 bytes
      数据预览: 3e 48 9e d0 06 ec 5c b3 0b 03 e5 92 40 73 9e bf ...
        C_ij:
    长度: 512 字符
    前32位: 3e489ed006ec5cb30b03e59240739ebf...
    后32位: 13f4a1eff795ea4df9f607c4fc158aa7
        product = prf * C_ij:
    长度: 576 字符
    前32位: 27109d61d0b433a41cc6580a02f319ee...
    后32位: 0e6b6919b059e297f01057b140aef915
        psi_mpz (累加后):
    长度: 256 字符
    前32位: 17b8c9ddaaaf3799bd9e8a9e797fe5ed...
    后32位: 7a5488a644633ddfce227d80797b42fe
    ✅ 处理了 16 个扇区

  [5.3] 计算 phi *= (TS_F[0])^prf_result
    ✅ TS_F[0] 反序列化成功
    读取字节数: 128
      theta_i:
    长度: 256 字符
    前32位: 84798ebcec7ae09be6c73c8e59d15700...
    后32位: 0b3fe25afc512eaa16f285a01fe2ec52
    ✅ 幂运算完成
      phi_temp = theta_i^prf:
    长度: 256 字符
    前32位: 548f2fa613eab56cd2c5199d1a1dd681...
    后32位: 36b9aff4dc4ac3778844356d8187c6d0
    ✅ phi 累乘完成
      phi_element (更新后):
    长度: 256 字符
    前32位: 548f2fa613eab56cd2c5199d1a1dd681...
    后32位: 36b9aff4dc4ac3778844356d8187c6d0

┌─────────────────────────────────────────┐
│ 处理块 [1/4]
└─────────────────────────────────────────┘

  [5.1] 计算 PRF(seed, ID_F, 1)
    ✅ PRF 计算完成
      prf_result:
    长度: 64 字符
    前32位: 43e7858121324a99e82039157e61528a...
    后32位: e5c307ec08421ce6404b2968a790a5f7

  [5.2] 处理块的所有扇区
    块起始位置: 4096
    块结束位置: 8192
    块大小: 4096 bytes
    ✅ 处理了 16 个扇区

  [5.3] 计算 phi *= (TS_F[1])^prf_result

┌─────────────────────────────────────────┐
│ 处理块 [2/4]
└─────────────────────────────────────────┘

  [5.1] 计算 PRF(seed, ID_F, 2)
    ✅ PRF 计算完成
      prf_result:
    长度: 64 字符
    前32位: 6c0130267381ceab153aaa62ec87a7b2...
    后32位: 8a58ca3353310beece0373c99dc6eb00

  [5.2] 处理块的所有扇区
    块起始位置: 8192
    块结束位置: 12288
    块大小: 4096 bytes
    ✅ 处理了 16 个扇区

  [5.3] 计算 phi *= (TS_F[2])^prf_result

  ... 继续处理剩余 2 个块（不显示详情）...

┌─────────────────────────────────────────┐
│ 处理块 [3/4]
└─────────────────────────────────────────┘

  [5.1] 计算 PRF(seed, ID_F, 3)
    ✅ PRF 计算完成
      prf_result:
    长度: 64 字符
    前32位: 56198aa2bc732c52a6592ba4382bc62b...
    后32位: fb8b306b938e126010edfc9cd8305862

  [5.2] 处理块的所有扇区
    块起始位置: 12288
    块结束位置: 16384
    块大小: 4096 bytes
    ✅ 处理了 16 个扇区

  [5.3] 计算 phi *= (TS_F[3])^prf_result

┌─────────────────────────────────────────┐
│ 处理块 [4/4]
└─────────────────────────────────────────┘

  [5.1] 计算 PRF(seed, ID_F, 4)
    ✅ PRF 计算完成
      prf_result:
    长度: 64 字符
    前32位: 72ce3f3ccdd4e2fed72d8b2c741ebcb1...
    后32位: 2a38afa2de7674ff2859d945edef3443

  [5.2] 处理块的所有扇区
    块起始位置: 16384
    块结束位置: 18992
    块大小: 2608 bytes
    ✅ 处理了 11 个扇区

  [5.3] 计算 phi *= (TS_F[4])^prf_result

✅ 所有块处理完成！

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤6】转换最终结果
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ psi 转换为十六进制字符串
    psi (最终):
    长度: 256 字符
    前64位: 5b2e708cf5eccbcb6ecfca2cdb122495c9edf443046bcedbfcdbedd4b141195f...
    后64位: f5b4ebf7c74aa3b4541289aa6987906bbb1149f1d141638010db2e0a7854be9f
✅ phi 转换为十六进制字符串
    phi (最终):
    长度: 256 字符
    前64位: 0af22785f42b3f28072c15b7028ad250e9bb451fe7366608f05602cb7202512e...
    后64位: b5db2df64415a259dadc6639d9cf41945fbf9e4b2fc6516229663c3a488feb9a

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤7】构建并保存JSON
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ JSON保存成功
  输出路径: ../data/FileProofs/15030926821912326204673978653733110398631717501691714889379196689817920475806.json

📄 JSON内容:
  {
    "ID_F": "15030926821912326204673978653733110398631717501691714889379196689817920475806",
    "FileProof": {
      "psi": "5b2e708cf5eccbcb6ecfca2cdb122495c9edf443046bcedbfcdbedd4b141195f...",
      "phi": "0af22785f42b3f28072c15b7028ad250e9bb451fe7366608f05602cb7202512e..."
    },
    "seed": "eb3e57764547952feef74615633ab0e94d9a30ff3e510d1adbc735a9587fe458"
  }

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 文件证明生成完成！
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🔍 文件证明验证 - 完整调试版本
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
证明文件: ../data/FileProofs/15030926821912326204673978653733110398631717501691714889379196689817920475806.json

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤1】加载证明文件
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 证明文件加载成功
  文件ID: 15030926821912326204673978653733110398631717501691714889379196689817920475806
    seed:
    长度: 64 字符
    完整: eb3e57764547952feef74615633ab0e94d9a30ff3e510d1adbc735a9587fe458
    psi:
    长度: 256 字符
    前64位: 5b2e708cf5eccbcb6ecfca2cdb122495c9edf443046bcedbfcdbedd4b141195f...
    后64位: f5b4ebf7c74aa3b4541289aa6987906bbb1149f1d141638010db2e0a7854be9f
    phi:
    长度: 256 字符
    前64位: 0af22785f42b3f28072c15b7028ad250e9bb451fe7366608f05602cb7202512e...
    后64位: b5db2df64415a259dadc6639d9cf41945fbf9e4b2fc6516229663c3a488feb9a

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤2】加载文件信息
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 文件信息加载成功
  块数量 n: 5
    公钥 PK:
    长度: 256 字符
    前32位: 0b97c9dd3c4a8a90ca1cdb176e937156...
    后32位: eae926c30a35160d50c7d192d81c5c71

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤3】反序列化证明数据
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[3.1] 反序列化 phi
  ✅ phi 反序列化成功
    phi_elem:
    长度: 256 字符
    前32位: 0af22785f42b3f28072c15b7028ad250...
    后32位: 5fbf9e4b2fc6516229663c3a488feb9a

[3.2] 转换 psi
  ✅ psi 转换成功
    psi_mpz:
    长度: 256 字符
    前32位: 5b2e708cf5eccbcb6ecfca2cdb122495...
    后32位: bb1149f1d141638010db2e0a7854be9f

[3.3] 反序列化 PK
  ✅ PK 反序列化成功
    PK_elem:
    长度: 256 字符
    前32位: 0b97c9dd3c4a8a90ca1cdb176e937156...
    后32位: eae926c30a35160d50c7d192d81c5c71

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤4】计算 zeta
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ zeta 初始化为单位元 1
    zeta (初始):
    长度: 256 字符
    前32位: 00000000000000000000000000000000...
    后32位: 00000000000000000000000000000000

开始循环计算 zeta...

  [块 0]
      prf_temp:
    长度: 64 字符
    前32位: a090ca885005a348134cc83580ebf806...
    后32位: fa0e82644da6a317b0e77e26edcea1e3
    H2 输入: "150309268219123262046739786537331103986317175016917148893791966898179204758060"
      h2_temp:
    长度: 256 字符
    前32位: 4dd860ef124559eb25839e009439e766...
    后32位: 8973b3e5dc2980a5e0156813fb0f92c0
      temp_pow = h2_temp^prf:
    长度: 256 字符
    前32位: 68062c7d2838e42b2f7ef6dfa8852ebe...
    后32位: e93496277714e32c15d0277e63d8608f
      zeta (更新后):
    长度: 256 字符
    前32位: 68062c7d2838e42b2f7ef6dfa8852ebe...
    后32位: e93496277714e32c15d0277e63d8608f

  [块 1]
      prf_temp:
    长度: 64 字符
    前32位: 43e7858121324a99e82039157e61528a...
    后32位: e5c307ec08421ce6404b2968a790a5f7
    H2 输入: "150309268219123262046739786537331103986317175016917148893791966898179204758061"
      h2_temp:
    长度: 256 字符
    前32位: 8d18789ce597528e90189978c0679eef...
    后32位: b05e9774c423872e99355d023f609cff
      temp_pow = h2_temp^prf:
    长度: 256 字符
    前32位: 48da0a6d4bd914892e7ddb5187f7db6d...
    后32位: faacb9f6c2413dc6fd9fb034b50b3ca5
      zeta (更新后):
    长度: 256 字符
    前32位: a68bad3413181e8b5f7b8e4692cb5c50...
    后32位: c3996c952d2bb00761c39e98e982251a

  [块 2]

  ... 处理中间块（不显示详情）...

  [块 4]

✅ zeta 计算完成
    zeta (最终):
    长度: 256 字符
    前64位: 976b1799362f93af6635baad8c05b5d3654179b7690cdd9369c44cc353c0e612...
    后64位: 6681693f9ac1778ef14cff80f09166ebd5b22914bb779eb26a3b4139fdec5aff

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤5】计算配对等式左边 left = e(phi, g)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ left 计算完成
    left = e(phi, g):
    长度: 256 字符
    前64位: 5e64f19b2a794cff64f1c02a96428c8f8579a0f66f4c95412d465c8b0e1c56f8...
    后64位: b3f8e503a557e17c0d083964d508ea95ab4978741f443ec87a0a1f1bbc6b045f

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤6】计算配对等式右边 right = e(zeta * μ^psi, PK)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[6.1] 计算 μ^psi
  ✅ μ^psi 计算完成
    μ^psi:
    长度: 256 字符
    前32位: 8bbb43cfd6f9272442decf09147e3314...
    后32位: f81247fa44b05a394f2d976927c1a8e4

[6.2] 计算 right_g1 = zeta * μ^psi
  ✅ right_g1 计算完成
    right_g1:
    长度: 256 字符
    前32位: 24f07279df6ac03ae8bbf0edc9f703d3...
    后32位: 5a097a134ce8b3bf87b891d515ee4575

[6.3] 计算 right = e(right_g1, PK)
  ✅ right 计算完成
    right = e(right_g1, PK):
    长度: 256 字符
    前64位: 00fd24d82423d0d8b6e9147cadb5d970f54a40ec8ec89472823bf3d992efd365...
    后64位: 25d7b624f3fc98b07707734c7183698840cc10e5307508dce8b0ab497f30b892

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
【步骤7】比较配对等式: left == right ?
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    left:
    长度: 256 字符
    前64位: 5e64f19b2a794cff64f1c02a96428c8f8579a0f66f4c95412d465c8b0e1c56f8...
    后64位: b3f8e503a557e17c0d083964d508ea95ab4978741f443ec87a0a1f1bbc6b045f
    right:
    长度: 256 字符
    前64位: 00fd24d82423d0d8b6e9147cadb5d970f54a40ec8ec89472823bf3d992efd365...
    后64位: 25d7b624f3fc98b07707734c7183698840cc10e5307508dce8b0ab497f30b892

  element_cmp(left, right) = 1
  (0 表示相等，非0表示不等)

  ❌ 配对等式不成立!
  ❌ e(phi, g) != e(zeta * μ^psi, PK)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
❌ 文件证明验证失败！
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 测试总结
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
文件ID: 15030926821912326204673978653733110398631717501691714889379196689817920475806
证明生成: ✅ 成功
证明验证: ❌ 失败

⚠️  测试失败，请查看 debug_output.txt 获取详细信息

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

所有调试数据已保存到: debug_output.txt
